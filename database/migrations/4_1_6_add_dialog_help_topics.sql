-- Migration: Add Dialog System help topics
-- Version: 4.1.6
-- Date: 2026-01-19
-- Module: Help System
-- Purpose: Add help topics for Dialog System, UTC_TIMEKEEPER, and Governance

-- Insert or update help topics (UPSERT - safe to run multiple times)
-- Each topic is a separate INSERT statement for better SQL compatibility

-- Topic 1: What is the Dialog System?
INSERT INTO `lupo_help_topics` (`slug`, `title`, `content_html`, `category`, `created_ymdhis`, `updated_ymdhis`, `is_deleted`) VALUES
('dialog-system', 'What is the Dialog System?', '<h1 id="dialog-system">What is the Dialog System?</h1>\n\n<p><strong>The Dialog System is the conversational memory of Lupopedia.</strong> It tracks every change, decision, and interaction with complete fidelity and chronological accuracy.</p>\n\n<h2 id="what-dialog-is">What the Dialog System Is</h2>\n<p>The Dialog System provides:</p>\n<ul>\n  <li><strong>Change Tracking</strong> - Complete history of all file modifications</li>\n  <li><strong>Agent Communication</strong> - Multi-agent coordination and handoffs</li>\n  <li><strong>Decision Documentation</strong> - Record of why changes were made</li>\n  <li><strong>Context Preservation</strong> - Maintain conversational context across time</li>\n  <li><strong>Audit Trail</strong> - Immutable record of system evolution</li>\n  <li><strong>Debugging Support</strong> - Historical context for troubleshooting</li>\n</ul>\n\n<h2 id="dialog-files">Dialog Files</h2>\n<p>Dialog files are stored in the <code>/dialogs/</code> directory:</p>\n<ul>\n  <li><strong>Default Thread:</strong> <code>dialogs/changelog_dialog.md</code> - Catch-all for files without dedicated threads</li>\n  <li><strong>Dedicated Threads:</strong> <code>dialogs/[filename]_dialog.md</code> - Specific file or topic tracking</li>\n  <li><strong>Thread Mapping:</strong> If a file has a dedicated thread, use it. Otherwise, use changelog_dialog.md</li>\n</ul>\n\n<h2 id="dialog-entries">Dialog Entries</h2>\n<p>Every dialog entry includes:</p>\n<ul>\n  <li><strong>Speaker</strong> - Who made the change (agent or human identifier)</li>\n  <li><strong>Target</strong> - Who needs to know (@everyone, @FLEET, @BRIDGE, etc.)</li>\n  <li><strong>Mood_RGB</strong> - Emotional context (6-character hex color)</li>\n  <li><strong>Message</strong> - What was changed (max 272 characters)</li>\n  <li><strong>Timestamp</strong> - UTC time in YYYYMMDDHHIISS format</li>\n</ul>\n\n<h2 id="newest-at-top">Newest-at-Top Rule</h2>\n<p><strong>All dialog entries MUST be ordered with newest entries at the top.</strong> This ensures the most recent changes are immediately visible.</p>\n\n<h2 id="governance-compliance">Governance Compliance</h2>\n<p>Dialog entries must comply with:</p>\n<ul>\n  <li><strong>GOV-AD-PROHIBIT-001</strong> - No commercial content, no ads, 100% ad-free</li>\n  <li><strong>LABS-001</strong> - Actor identification and truth state requirements</li>\n  <li><strong>Temporal Pillar</strong> - All timestamps use UTC_TIMEKEEPER (canonical UTC)</li>\n</ul>\n\n<h2 id="related-topics">Related Topics</h2>\n<ul>\n  <li>Read <a href="/help/utc-timekeeper">What is UTC_TIMEKEEPER?</a> for temporal requirements</li>\n  <li>See <a href="/help/governance-registry">What is the Governance Registry?</a> for governance artifacts</li>\n  <li>Visit <a href="/docs/doctrine/DIALOG_DOCTRINE.md">Dialog System Doctrine</a> for complete rules</li>\n</ul>', 'Core', 20260119034500, 20260119034500, 0)
ON DUPLICATE KEY UPDATE
    `title` = VALUES(`title`),
    `content_html` = VALUES(`content_html`),
    `category` = VALUES(`category`),
    `updated_ymdhis` = VALUES(`updated_ymdhis`);

-- Topic 2: What is UTC_TIMEKEEPER?
INSERT INTO `lupo_help_topics` (`slug`, `title`, `content_html`, `category`, `created_ymdhis`, `updated_ymdhis`, `is_deleted`) VALUES
('utc-timekeeper', 'What is UTC_TIMEKEEPER?', '<h1 id="utc-timekeeper">What is UTC_TIMEKEEPER?</h1>\n\n<p><strong>UTC_TIMEKEEPER is the single source of truth for all timestamps in Lupopedia.</strong> It ensures temporal integrity across the entire system.</p>\n\n<h2 id="what-utc-timekeeper-is">What UTC_TIMEKEEPER Is</h2>\n<p>UTC_TIMEKEEPER is:</p>\n<ul>\n  <li><strong>Canonical Time Service</strong> - Single source of truth for all timestamps</li>\n  <li><strong>Temporal Pillar Implementation</strong> - Enforces "Time is the Spine" doctrine</li>\n  <li><strong>Format Provider</strong> - Returns timestamps in YYYYMMDDHHIISS format (BIGINT)</li>\n  <li><strong>UTC Only</strong> - All timestamps are in Coordinated Universal Time</li>\n  <li><strong>LABS-001 Required</strong> - Temporal alignment is Declaration #1 in LABS-001</li>\n</ul>\n\n<h2 id="temporal-pillar">Temporal Pillar Integration</h2>\n<p>The Temporal Pillar states: <strong>"Time is the Spine"</strong> of the semantic operating system. UTC_TIMEKEEPER implements this by:</p>\n<ul>\n  <li><strong>Providing canonical UTC</strong> - All events must have canonical UTC timestamps</li>\n  <li><strong>Enforcing format</strong> - YYYYMMDDHHIISS format (14 digits, BIGINT)</li>\n  <li><strong>Preventing drift</strong> - No system clocks, no timezone inference, no file metadata timestamps</li>\n  <li><strong>Maintaining integrity</strong> - Temporal integrity is inviolable</li>\n</ul>\n\n<h2 id="usage-rules">Usage Rules</h2>\n<p><strong>MANDATORY: Agents must never infer the current date or time from:</strong></p>\n<ul>\n  <li>File metadata</li>\n  <li>OS time</li>\n  <li>Commit history</li>\n  <li>File content</li>\n  <li>System clocks</li>\n  <li>Local timezone information</li>\n</ul>\n\n<p><strong>If the current UTC date/time is required, the agent must:</strong></p>\n<ul>\n  <li>Request it explicitly from the user</li>\n  <li>Wait for explicit confirmation</li>\n  <li>Never assume or infer the current time</li>\n  <li>Use UTC_TIMEKEEPER as the canonical source</li>\n</ul>\n\n<h2 id="timestamp-format">Timestamp Format</h2>\n<p>All timestamps in Lupopedia use this format:</p>\n<ul>\n  <li><strong>Format:</strong> <code>YYYYMMDDHHIISS</code> (14 digits)</li>\n  <li><strong>Example:</strong> <code>20260119120000</code> = January 19, 2026, 12:00:00 UTC</li>\n  <li><strong>Storage:</strong> BIGINT in database (not DATETIME or TIMESTAMP)</li>\n  <li><strong>Source:</strong> UTC_TIMEKEEPER (canonical time service)</li>\n</ul>\n\n<h2 id="database-fields">Database Fields</h2>\n<p>Common temporal fields in database tables:</p>\n<ul>\n  <li><code>created_ymdhis</code> - When the record was created (BIGINT, UTC)</li>\n  <li><code>updated_ymdhis</code> - When the record was last updated (BIGINT, UTC)</li>\n  <li><code>deleted_ymdhis</code> - When the record was soft-deleted (BIGINT, UTC, nullable)</li>\n</ul>\n\n<p><strong>Never use:</strong> DATETIME, TIMESTAMP, or any timezone-aware types. Always use BIGINT with YYYYMMDDHHIISS format.</p>\n\n<h2 id="related-topics">Related Topics</h2>\n<ul>\n  <li>Read <a href="/help/temporal-pillar">What is the Temporal Pillar?</a> for complete temporal doctrine</li>\n  <li>See <a href="/help/labs-001">LABS-001: Actor Baseline State</a> for temporal alignment requirements</li>\n  <li>Visit <a href="/docs/doctrine/UTC_TIMEKEEPER_DOCTRINE.md">UTC_TIMEKEEPER Doctrine</a> for complete specification</li>\n</ul>', 'Core', 20260119034500, 20260119034500, 0)
ON DUPLICATE KEY UPDATE
    `title` = VALUES(`title`),
    `content_html` = VALUES(`content_html`),
    `category` = VALUES(`category`),
    `updated_ymdhis` = VALUES(`updated_ymdhis`);

-- Topic 3: What is the Governance Registry?
INSERT INTO `lupo_help_topics` (`slug`, `title`, `content_html`, `category`, `created_ymdhis`, `updated_ymdhis`, `is_deleted`) VALUES
('governance-registry', 'What is the Governance Registry?', '<h1 id="governance-registry">What is the Governance Registry?</h1>\n\n<p><strong>The Governance Registry (GOV-REGISTRY-001) is the canonical registry of all governance artifacts within Lupopedia.</strong> It serves as the authoritative source of truth for which governance artifacts are active and binding.</p>\n\n<h2 id="what-registry-is">What the Governance Registry Is</h2>\n<p>The Governance Registry provides:</p>\n<ul>\n  <li><strong>Canonical Source</strong> - Single source of truth for all governance artifacts</li>\n  <li><strong>Status Tracking</strong> - Active, deprecated, or pending governance artifacts</li>\n  <li><strong>Compliance Requirements</strong> - Which artifacts require LABS-001 compliance</li>\n  <li><strong>Version Management</strong> - Version tracking for each governance artifact</li>\n  <li><strong>Validation Cycles</strong> - Revalidation requirements (e.g., 24-hour cycles)</li>\n</ul>\n\n<h2 id="registered-artifacts">Registered Governance Artifacts</h2>\n<p>Currently registered artifacts:</p>\n<ul>\n  <li><strong>GOV-AD-PROHIBIT-001</strong> - Anti-Advertising Law (v1.0.0, ACTIVE)</li>\n  <li><strong>LABS-001</strong> - Lupopedia Actor Baseline State (v1.1.0, ACTIVE)</li>\n</ul>\n\n<h2 id="registry-location">Registry Location</h2>\n<p>The Governance Registry is located at:</p>\n<ul>\n  <li><strong>File:</strong> <code>docs/governance/REGISTRY.md</code></li>\n  <li><strong>Status:</strong> ACTIVE & CANONICAL</li>\n  <li><strong>Version:</strong> 1.0.0</li>\n</ul>\n\n<h2 id="compliance-tracking">Compliance Tracking</h2>\n<p>The registry tracks:</p>\n<ul>\n  <li><strong>LABS Required</strong> - Whether the artifact requires LABS-001 compliance</li>\n  <li><strong>Revalidation Cycle</strong> - How often actors must revalidate compliance</li>\n  <li><strong>Priority</strong> - Critical, High, Medium, Low</li>\n  <li><strong>Established Date</strong> - When the artifact was created</li>\n</ul>\n\n<h2 id="using-the-registry">Using the Registry</h2>\n<p>All actors, agents, and modules must:</p>\n<ul>\n  <li><strong>Reference the registry</strong> to determine active governance artifacts</li>\n  <li><strong>Check compliance requirements</strong> before performing actions</li>\n  <li><strong>Update the registry</strong> when creating new governance artifacts</li>\n  <li><strong>Follow validation cycles</strong> for artifacts requiring revalidation</li>\n</ul>\n\n<h2 id="related-topics">Related Topics</h2>\n<ul>\n  <li>Read <a href="/help/labs-001">LABS-001: Actor Baseline State</a> for compliance requirements</li>\n  <li>See <a href="/help/gov-ad-prohibit-001">GOV-AD-PROHIBIT-001: Anti-Advertising Law</a> for advertising rules</li>\n  <li>Visit <a href="/docs/governance/REGISTRY.md">Governance Registry</a> for complete artifact list</li>\n</ul>', 'Core', 20260119034500, 20260119034500, 0)
ON DUPLICATE KEY UPDATE
    `title` = VALUES(`title`),
    `content_html` = VALUES(`content_html`),
    `category` = VALUES(`category`),
    `updated_ymdhis` = VALUES(`updated_ymdhis`);

-- Topic 4: GOV-AD-PROHIBIT-001: Anti-Advertising Law
INSERT INTO `lupo_help_topics` (`slug`, `title`, `content_html`, `category`, `created_ymdhis`, `updated_ymdhis`, `is_deleted`) VALUES
('gov-ad-prohibit-001', 'GOV-AD-PROHIBIT-001: Anti-Advertising Law', '<h1 id="gov-ad-prohibit-001">GOV-AD-PROHIBIT-001: Anti-Advertising Law</h1>\n\n<p><strong>GOV-AD-PROHIBIT-001 is the Anti-Advertising Law that prevents any actor, agent, or subsystem from injecting commercial, promotional, or manipulative advertising into the Lupopedia ecosystem.</strong></p>\n\n<h2 id="purpose">Purpose</h2>\n<p>The Anti-Advertising Law ensures:</p>\n<ul>\n  <li><strong>System Integrity</strong> - Lupopedia output remains 100% ad-free</li>\n  <li><strong>User Trust</strong> - No commercial manipulation or hidden agendas</li>\n  <li><strong>Content Purity</strong> - All system-generated content is non-commercial</li>\n  <li><strong>Boundary Clarity</strong> - Clear distinction between system output and environmental context</li>\n</ul>\n\n<h2 id="scope">Scope</h2>\n<p>GOV-AD-PROHIBIT-001 applies to:</p>\n<ul>\n  <li><strong>All actors</strong> - Human users and system actors</li>\n  <li><strong>All agents</strong> - Kernel and domain agents</li>\n  <li><strong>All modules</strong> - HELP, LIST, LABS, CONTENT, etc.</li>\n  <li><strong>All system output</strong> - UI, responses, documentation, dialog entries</li>\n</ul>\n\n<h2 id="prohibited">What is PROHIBITED</h2>\n<p>The following are strictly prohibited:</p>\n<ul>\n  <li>❌ Third-party ads appearing in Lupopedia\'s UI</li>\n  <li>❌ Third-party ads in system output</li>\n  <li>❌ Third-party ads in agent responses</li>\n  <li>❌ Third-party ads in any module</li>\n  <li>❌ Any commercial content displayed by Lupopedia</li>\n  <li>❌ Any bio-to-human interface (beyond visual and hearing) that Lupopedia *generates or controls* and contains commercial content</li>\n</ul>\n\n<h2 id="allowed">What is ALLOWED (Environmental Context)</h2>\n<p>The following are allowed as environmental context:</p>\n<ul>\n  <li>✅ External audio streams (Pandora, K‑LOVE) playing on the Captain\'s computer</li>\n  <li>✅ Real-world billboards and physical advertisements</li>\n  <li>✅ YouTube pre-rolls (if YouTube is external to Lupopedia\'s UI)</li>\n  <li>✅ Notifications from other apps</li>\n  <li>✅ Background noise and physical environment</li>\n  <li>✅ Any bio-to-human interface from *external environmental sources* that Lupopedia *cannot control*</li>\n</ul>\n\n<p><strong>The Rule:</strong> If it appears in Lupopedia\'s UI or system output, it\'s PROHIBITED. If it\'s external environmental context that Lupopedia cannot control, it\'s ALLOWED.</p>\n\n<h2 id="enforcement">Enforcement</h2>\n<p>Violations are:</p>\n<ul>\n  <li><strong>Logged</strong> in <code>lupo_labs_violations</code> table</li>\n  <li><strong>Tracked</strong> with violation code: <code>GOV-AD-PROHIBIT-001</code></li>\n  <li><strong>Documented</strong> with actor_id, certificate_id (if applicable), and description</li>\n  <li><strong>Educated</strong> - Actors are informed, not penalized</li>\n</ul>\n\n<h2 id="boundary-rule">The Boundary Rule</h2>\n<p>The distinction is clear and absolute:</p>\n<blockquote>\n  <p><strong>If Lupopedia didn\'t generate it, it\'s environmental context.</strong><br>\n  <strong>If Lupopedia did generate it, it must be ad-free.</strong></p>\n</blockquote>\n\n<h2 id="related-topics">Related Topics</h2>\n<ul>\n  <li>Read <a href="/help/environmental-context">What is Environmental Context?</a> for boundary definitions</li>\n  <li>See <a href="/help/governance-registry">What is the Governance Registry?</a> for artifact tracking</li>\n  <li>Visit <a href="/docs/doctrine/GOV_AD_PROHIBIT_001.md">GOV-AD-PROHIBIT-001 Doctrine</a> for complete governance artifact</li>\n</ul>', 'Core', 20260119034500, 20260119034500, 0)
ON DUPLICATE KEY UPDATE
    `title` = VALUES(`title`),
    `content_html` = VALUES(`content_html`),
    `category` = VALUES(`category`),
    `updated_ymdhis` = VALUES(`updated_ymdhis`);

-- Topic 5: LABS-001: Actor Baseline State
INSERT INTO `lupo_help_topics` (`slug`, `title`, `content_html`, `category`, `created_ymdhis`, `updated_ymdhis`, `is_deleted`) VALUES
('labs-001', 'LABS-001: Actor Baseline State', '<h1 id="labs-001">LABS-001: Actor Baseline State</h1>\n\n<p><strong>LABS-001 (Lupopedia Actor Baseline State) is the mandatory pre-interaction protocol for all actors in Lupopedia.</strong> It ensures that all actors are aligned with system doctrine, governance, and truth state requirements before they can interact with the system.</p>\n\n<h2 id="what-labs-001-is">What LABS-001 Is</h2>\n<p>LABS-001 requires actors to:</p>\n<ul>\n  <li><strong>Declare Temporal Alignment</strong> - Accept UTC as canonical timeline (YYYYMMDDHHIISS)</li>\n  <li><strong>Acknowledge Doctrine Pillar</strong> - Doctrine (Law) precedes code</li>\n  <li><strong>Accept Zero Distance</strong> - UI is a transparent reflection of the Schema</li>\n  <li><strong>Comply with Governance</strong> - Acknowledge GOV-AD-PROHIBIT-001 and other active governance artifacts</li>\n  <li><strong>Declare Truth State</strong> - Explicitly state Known, Assumed, Unknown, and Prohibited knowledge</li>\n  <li><strong>Recognize Authority</strong> - Acknowledge system governor and Pack leader</li>\n</ul>\n\n<h2 id="ten-declarations">The 10 Mandatory Declarations</h2>\n<p>Every actor must complete 10 declarations:</p>\n<ol>\n  <li><strong>Temporal Alignment</strong> - Current UTC timestamp from UTC_TIMEKEEPER</li>\n  <li><strong>Actor Identity</strong> - Role, type, and identifier</li>\n  <li><strong>Wolf Recognition</strong> - Acknowledge human architect and system governor</li>\n  <li><strong>Purpose</strong> - Scope, purpose, and limitations</li>\n  <li><strong>Constraints</strong> - Governance laws and operational constraints</li>\n  <li><strong>Prohibited Actions</strong> - Actions the actor must never perform</li>\n  <li><strong>Task Context</strong> - Current task and expected output</li>\n  <li><strong>Truth State</strong> - Known, Assumed (with probability), Unknown, Prohibited</li>\n  <li><strong>Governance Compliance</strong> - Active governance artifacts acknowledged</li>\n  <li><strong>Authority Recognition</strong> - System governor and authority source</li>\n</ol>\n\n<h2 id="certificate-generation">Certificate Generation</h2>\n<p>Upon successful completion of all 10 declarations:</p>\n<ul>\n  <li><strong>Certificate ID</strong> is generated (e.g., <code>LABS-CERT-735455a449531697fed1022cdcca19ec</code>)</li>\n  <li><strong>Declaration stored</strong> in <code>lupo_labs_declarations</code> table</li>\n  <li><strong>Revalidation cycle</strong> begins (typically 24 hours)</li>\n  <li><strong>Compliance tracking</strong> enabled for the actor</li>\n</ul>\n\n<h2 id="violation-tracking">Violation Tracking</h2>\n<p>Violations of LABS-001 requirements are logged in <code>lupo_labs_violations</code> table:</p>\n<ul>\n  <li><strong>Violation Code</strong> - Specific violation type (e.g., <code>GOV-AD-PROHIBIT-001</code>)</li>\n  <li><strong>Actor ID</strong> - Which actor violated the requirement</li>\n  <li><strong>Certificate ID</strong> - Associated LABS-001 certificate (if applicable)</li>\n  <li><strong>Description</strong> - What violation occurred</li>\n  <li><strong>Timestamp</strong> - When the violation occurred (UTC, YYYYMMDDHHIISS)</li>\n</ul>\n\n<h2 id="truth-state-framework">Truth State Framework</h2>\n<p>Every actor must declare their truth state with four categories:</p>\n<ul>\n  <li><strong>Known</strong> - Verified facts with sources (100% certainty)</li>\n  <li><strong>Assumed</strong> - Uncertainties with probability weights (0.0-1.0), justification, and expiration</li>\n  <li><strong>Unknown</strong> - Explicitly declared knowledge gaps</li>\n  <li><strong>Prohibited</strong> - Knowledge areas the actor cannot access</li>\n</ul>\n\n<p><strong>Key Rule:</strong> A probabilistic statement (with weight) is honest uncertainty. A lie is concealed falsehood. See <a href="/help/probability-vs-lie">Probability vs Lie</a> for the distinction.</p>\n\n<h2 id="related-topics">Related Topics</h2>\n<ul>\n  <li>Read <a href="/help/probability-vs-lie">Probability vs Lie: What\'s the Difference?</a> for truth state clarification</li>\n  <li>See <a href="/help/utc-timekeeper">What is UTC_TIMEKEEPER?</a> for temporal requirements</li>\n  <li>Visit <a href="/docs/templates/LABS_HANDSHAKE_TEMPLATE.md">LABS-001 Handshake Template</a> to complete your declaration</li>\n  <li>Read <a href="/docs/doctrine/LUPOPEDIA_ACTOR_BASELINE_STATE_DOCTRINE.md">LABS-001 Doctrine</a> for complete specification</li>\n</ul>', 'Core', 20260119034500, 20260119034500, 0)
ON DUPLICATE KEY UPDATE
    `title` = VALUES(`title`),
    `content_html` = VALUES(`content_html`),
    `category` = VALUES(`category`),
    `updated_ymdhis` = VALUES(`updated_ymdhis`);
