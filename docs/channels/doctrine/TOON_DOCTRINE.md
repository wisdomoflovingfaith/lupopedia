---
architect: Captain Wolfie
wolfie.headers: explicit architecture with structured clarity for every file.
file.last_modified_system_version: 4.0.14
header_atoms:
  - GLOBAL_CURRENT_LUPOPEDIA_VERSION
  - GLOBAL_CURRENT_AUTHORS
dialog:
  speaker: CURSOR
  target: @everyone
  message: Updated TOON_DOCTRINE.md to clarify TOON files are READ-ONLY for all IDEs and agents. Only Python cron job writes TOON files. Database is authoritative source. Schema is fluid during active development.
tags:
  categories: ["documentation", "doctrine", "toon", "cursor"]
  collections: ["core-docs", "doctrine"]
  channels: ["dev"]
in_this_file_we_have:
  - TOON Files Are READ-ONLY for IDEs and Agents
  - Database Is the Authoritative Source
  - TOON File Generation Workflow
  - Schema Forging Phase
  - What Agents Must NOT Do
  - Agent Role During Development
file:
  title: "TOON Doctrine"
  description: "Mandatory rules Cursor must follow when working with TOON format files in Lupopedia 4.0.1"
  version: "4.1.0"
  status: published
  author: "Captain Wolfie"
---

# â­ **TOON DOCTRINE â€” MANDATORY**

### **TOON Files Are READ-ONLY for All IDEs and Agents**

This doctrine is **mandatory**. All IDEs (Cursor, Windsurf, DeepSeek, etc.) and agents must follow it when working with TOON format files.

---

## **ðŸ”´ 1. TOON Files Are READ-ONLY for IDEs and Agents**

**CRITICAL:** TOON files in `database/toon_data/` are **READ-ONLY** for all IDEs and agents.

**Only the Python cron job writes TOON files.**

**The database (phpMyAdmin) is the authoritative source of truth.**

**TOON files are a reflection of the database, not an editable artifact.**

### **What This Means**

- âœ… **READ** TOON files to understand the schema
- âœ… **REFERENCE** TOON files when writing code or documentation
- âŒ **NEVER** modify TOON files
- âŒ **NEVER** regenerate TOON files
- âŒ **NEVER** fix TOON files
- âŒ **NEVER** treat TOON files as writable

### **Correct Workflow**

1. **Eric updates tables directly in phpMyAdmin** (authoritative source)
2. **Python script regenerates TOON files from the database** (automated cron job)
3. **Agents and IDEs read TOON files** to understand the schema (read-only)
4. **Agents update documentation only**, not TOON files (write to docs)

### **During Active Development**

- The schema is **fluid** â€” tables may be redesigned, renamed, or dropped at any time
- **No migration scripts are required** unless explicitly requested
- This is the **schema forging phase**, not the migration phase
- TOON files will be automatically regenerated by the Python script when the database changes

### **Agent Responsibilities**

During this phase, agents must:
- âœ… Update documentation
- âœ… Maintain clarity
- âœ… Understand the schema from TOON files
- âŒ Do NOT modify TOON files
- âŒ Do NOT modify the database
- âŒ Do NOT attempt to fix TOON files

---

## **ðŸ”´ 2. Database Is the Authoritative Source of Truth**

**The database (phpMyAdmin) is the ONLY source of truth for schema.**

**Manual schema alterations performed in phpMyAdmin are authoritative and must be treated as the source of truth.**

**TOON files are automatically generated reflections of the database.**

**If there's a discrepancy:**
- The database is correct
- The TOON file will be regenerated automatically
- Do NOT fix the TOON file â€” wait for regeneration

**Cursor must NOT attempt to:**
- âŒ Revert schema changes
- âŒ "Optimize" the schema
- âŒ Re-infer schema structure
- âŒ Regenerate schema from old versions
- âŒ Overwrite manual schema updates

---

## **ðŸ”´ 3. TOON File Generation Workflow**

**TOON files are generated automatically by a Python script that reads the live database schema.**

**The Python script:**
- Connects to the live database
- Reads table structures from INFORMATION_SCHEMA
- Generates TOON files in `database/toon_data/`
- Runs automatically via cron job

**Any changes made to TOON files will be overwritten by the Python cron job.**

---

## **ðŸ”´ 4. Schema Forging Phase**

**During active development, the schema is fluid:**

- Tables may be redesigned, renamed, or dropped at any time
- Columns may be added, removed, or modified
- No migration scripts are required unless explicitly requested
- This is the **schema forging phase**, not the migration phase

**Agents must adapt to schema changes, not prevent them.**

---

## **ðŸ”´ 5. What Agents Must NOT Do**

**Agents and IDEs must NOT attempt to:**

- âŒ Regenerate TOON files
- âŒ Update TOON files
- âŒ Fix TOON files
- âŒ Treat TOON files as writable
- âŒ Modify schema through TOON files
- âŒ "Correct" TOON files
- âŒ Write scripts to generate TOON files
- âŒ Revert schema changes made in phpMyAdmin
- âŒ "Optimize" the schema
- âŒ Re-infer schema structure
- âŒ Regenerate schema from old versions
- âŒ Overwrite manual schema updates
- âŒ Convert TOON files to JSON
- âŒ Infer schema from old TOON file versions

---

## **ðŸ”´ 6. Agent Role During Development**

**Your role during this phase:**

- âœ… **Update documentation** â€” Keep docs in sync with schema changes
- âœ… **Maintain clarity** â€” Document schema decisions and changes
- âœ… **Understand the schema** â€” Read TOON files to understand structure
- âŒ **Do NOT modify TOON files**
- âŒ **Do NOT modify the database**
- âŒ **Do NOT attempt to fix TOON files**

**If you notice a discrepancy between TOON files and the database:**
- Trust the database (it's the source of truth)
- Wait for the Python script to regenerate TOON files
- Update documentation if needed

---

## **ðŸ”µ 7. TOON Is Not JSON**

**Cursor must recognize that all refactor files, agent files, and schema mapping files in Lupopedia 4.0.0 are written in TOON format, NOT JSON.**

**TOON is a meaning-preserving, token-efficient structured format.**

**TOON is NOT:**
- JSON
- YAML
- XML
- TOML
- INI
- JavaScript objects

**Critical Rule:**
- Files may have `.json` extensions, but they are TOON format
- TOON is not JSON, even if it looks similar
- Never treat TOON as JSON

---

## **ðŸ”µ 2. What TOON Is**

**TOON is:**
- A semantic mapping format
- Meaning-preserving
- Token-efficient
- Structured for human and machine reading
- Used for refactor mappings, agent configurations, and schema definitions

**TOON files are located in:**
- `database/toon_data/` â€” Table structure definitions (READ-ONLY, generated from database)
- `database/refactors/` â€” Table and column mapping files (EDITABLE - migration mappings)
- `lupo-agents/` â€” Agent configuration files (READ-ONLY unless explicitly instructed)
- Other schema mapping locations

**Critical Rule:**
- TOON files in `database/toon_data/` are READ-ONLY (generated from database)
- Files in `database/refactors/` (whether `.toon` or `.json`) are EDITABLE (migration mappings)
- TOON is a semantic format, not a data serialization format
- TOON preserves meaning, not just syntax
- TOON is designed for mapping and configuration

---

## **ðŸ”µ 3. What TOON Is NOT**

**TOON is NOT:**
- A data serialization format
- A strict syntax format
- JSON-compatible
- YAML-compatible
- A format that requires validation

**Critical Rule:**
- Don't treat TOON as if it needs JSON validation
- Don't expect TOON to follow JSON rules
- Don't assume TOON is JSON just because it looks similar

---

## **ðŸ”µ 4. Cursor Must Never Convert TOON**

**Cursor must NEVER:**
- convert TOON to JSON
- rewrite TOON as JSON
- validate TOON as JSON
- add quotes, commas, or braces to make it "valid JSON"
- enforce JSON syntax rules on TOON
- assume TOON structure is JSON
- "fix" TOON formatting to match JSON

**Critical Rule:**
- TOON is TOON, not JSON
- Never convert or rewrite TOON
- Never "fix" TOON to be JSON-compatible

---

## **ðŸ”µ 5. Cursor Must Preserve TOON Exactly**

**Cursor must preserve TOON exactly as written, including:**
- indentation
- spacing
- key order
- symbolic structure
- comments
- meaning blocks

**Critical Rule:**
- Don't reformat TOON
- Don't reorder TOON keys
- Don't change TOON structure
- Preserve TOON exactly as it is

---

## **ðŸ”µ 6. TOON Is a Semantic Mapping Format**

**Cursor must treat TOON as a semantic mapping file, not a data serialization format.**

**Cursor must read TOON keys and values as meaning, not syntax.**

**Critical Rule:**
- TOON represents meaning and mappings
- Read TOON for its semantic content
- Don't focus on syntax validation
- Focus on the meaning and mappings

---

## **ðŸ”µ 7. TOON Files Are Read-Only Reference Materials**

**Agents must use TOON files in `database/toon_data/` as READ-ONLY references for table structure and column names.**

**Critical Rules:**
- TOON files in `database/toon_data/` are authoritative **references** (read-only)
- Never guess mappings when TOON files exist
- Always reference TOON files for schema information
- TOON files reflect the database structure (read from database, not written by agents)
- Do NOT modify TOON files in `database/toon_data/` â€” they are regenerated automatically

---

## **ðŸŸ¢ 7A. `database/refactors/` Files Are EDITABLE (Exception)**

**âš ï¸ EXCEPTION: Files in `database/refactors/` are EDITABLE by Cursor and IDEs.**

**This is the ONLY directory where Cursor may modify structured data files.**

**Files in `database/refactors/` (whether `.toon` or `.json`) are intentionally designed to be updated, expanded, corrected, and refined by Cursor or any IDE as migration work progresses.**

**These files are the "living documentation" of the migration and represent:**
- Legacy â†’ new table mappings
- Column mappings
- Transforms
- Merge rules
- Rewrite rules
- Migration notes
- Crafty Syntax 3.7.5 â†’ Lupopedia 4.0.0 upgrade logic

**Purpose of `database/refactors/` Files:**
These files are the "living documentation" and "migration brain" that track:
- Every legacy table â†’ new Lupopedia table mapping
- Every legacy column â†’ new column mapping
- Transforms and conversion rules
- Merge rules for combining data
- Rewrite rules for SQL and PHP code
- Migration notes and edge cases
- Crafty Syntax 3.7.5 â†’ Lupopedia 4.0.0 upgrade logic

**Critical Rules for `database/refactors/` files:**
- âœ… **EDITABLE** â€” Cursor may modify files in this directory (`.toon` or `.json`)
- âœ… **UPDATE** â€” As we discover new legacy columns, missing mappings, edge cases
- âœ… **EXPAND** â€” Add new mappings and transforms as migration progresses
- âœ… **REFINE** â€” Correct and improve migration rules
- âœ… **USE** â€” Reference these files when rewriting legacy code
- âœ… **MAKE NOTES** â€” Add migration notes, edge cases, Crafty Syntax quirks
- âœ… **EVOLVE** â€” These files evolve as migration work continues
- âŒ **DO NOT** modify the live database schema â€” only update the refactor files
- âŒ **DO NOT** modify files in `database/toon_data/` â€” those are read-only
- âŒ **DO NOT** modify other JSON/TOON files outside this directory

**When rewriting legacy code, Cursor must use `database/refactors/` files as the source of truth for:**
- Old table names â†’ new table names
- Old column names â†’ new column names
- Transforms (e.g., `Y_to_1_else_0`, date format conversions)
- Merge rules (how to combine duplicate rows)
- Rewrite rules (how to rewrite SQL queries)
- Legacy â†’ modern naming conventions

**This is how we automate the Crafty Syntax â†’ Lupopedia upgrade while preserving legacy behavior.**

---

## **ðŸ”µ 8. Cursor Must Not Waste Tokens Converting TOON**

**Cursor must NOT waste tokens converting TOON into JSON or any other format.**

**Cursor must work with TOON directly as TOON.**

**Critical Rule:**
- Don't convert TOON to JSON for processing
- Don't parse TOON as JSON
- Work with TOON in its native format
- Use TOON keys and values directly

---

## **ðŸ”µ 9. Examples of TOON Usage**

**TOON files are used for:**
- Table name mappings (`database/refactors/{legacy_table}.json`)
- Column name mappings (`database/refactors/{legacy_table}.json`)
- Table structure definitions (`database/toon_data/{table_name}.json`)
- Agent configurations (`lupo-agents/{agent_name}/`)
- Schema mappings and transforms

**Critical Rule:**
- All these files are TOON format
- Even if they have `.json` extensions, they are TOON
- Never convert them to JSON

---

## **ðŸ”µ 10. Cursor's Responsibility with TOON**

**When Cursor encounters a TOON file in `database/toon_data/`:**

1. **Recognize it as TOON** â€” Not JSON, not YAML, not any other format
2. **Read it as TOON** â€” Extract meaning and mappings
3. **Use it as TOON** â€” Reference keys and values directly
4. **Preserve it as TOON** â€” Never convert or rewrite (READ-ONLY)
5. **Respect it as TOON** â€” Don't enforce JSON rules

**Critical Rule:**
- TOON files in `database/toon_data/` are READ-ONLY
- Work with TOON as TOON
- Never convert TOON to anything else
- Never modify TOON files â€” they are regenerated automatically

**When Cursor encounters a file in `database/refactors/` (`.toon` or `.json`):**

1. **Recognize it as editable migration mapping** â€” Legacy â†’ new table/column mappings
2. **Read it for migration rules** â€” Extract table mappings, column mappings, transforms
3. **Update it as needed** â€” Add new mappings, correct errors, expand coverage
4. **Use it for code rewriting** â€” Reference when rewriting legacy SQL, PHP, AJAX, etc.
5. **Treat it as "living documentation"** â€” Evolves as migration progresses
6. **Add notes** â€” Document edge cases, Crafty Syntax quirks, migration discoveries

**Critical Rules for `database/refactors/` files:**
- âœ… **EDITABLE** â€” These are the only structured files Cursor may modify
- âœ… **UPDATE** â€” As we discover new legacy structures, missing mappings, edge cases
- âœ… **EXPAND** â€” Add new mappings, transforms, merge rules
- âœ… **REFINE** â€” Correct errors, improve migration logic
- âœ… **USE** â€” Reference when rewriting legacy Crafty Syntax code
- âœ… **MAKE NOTES** â€” Document migration discoveries and quirks
- âŒ **DO NOT** modify live database schema â€” only update refactor files
- âŒ **DO NOT** modify files in `database/toon_data/` â€” those are read-only
- âŒ **DO NOT** modify other JSON/TOON files outside this directory

---

## **â­ Summary**

**This doctrine is mandatory.**

**Key Principles:**

### **READ-ONLY Files (Do NOT Modify):**
1. **TOON files in `database/toon_data/`** â€” READ-ONLY, regenerated by Python cron job
2. **Database schema** â€” phpMyAdmin is authoritative, Cursor must not modify
3. **All other JSON/TOON files** â€” Read-only unless explicitly instructed

### **EDITABLE Files (May Modify):**
4. **JSON files in `database/refactors/`** â€” EDITABLE migration mapping files
   - Legacy â†’ new table mappings
   - Column mappings
   - Transforms and merge rules
   - Crafty Syntax 3.7.5 â†’ Lupopedia 4.0.0 upgrade logic

### **General Rules:**
5. **Database is authoritative** â€” Manual schema alterations in phpMyAdmin are source of truth
6. **TOON files are reflections** â€” Generated from database, not editable
7. **Schema is fluid** â€” During active development, tables change frequently
8. **No migrations needed** â€” Schema forging phase, not migration phase
9. **Refactor JSON files evolve** â€” Update as migration progresses, discover edge cases
10. **TOON is not JSON** â€” Even if files have `.json` extensions
11. **Never convert TOON** â€” Don't rewrite, don't validate as JSON, don't "fix"
12. **Use refactor JSON for rewriting** â€” Reference when rewriting legacy SQL, PHP, AJAX

**This is how TOON files and refactor JSON files are handled in Lupopedia 4.0.0.**

---

## **Related Documentation**

- **[DATABASE_PHILOSOPHY.md](../architecture/DATABASE_PHILOSOPHY.md)** â€” Database is authoritative source; application logic first, database logic second
- **[AI_SCHEMA_GUIDE.md](../schema/AI_SCHEMA_GUIDE.md)** â€” Why TOON files exist and how AI tools must use them
- **[DATABASE_SCHEMA.md](../schema/DATABASE_SCHEMA.md)** â€” Complete database structure that TOON files reflect

---

*Last Updated: January 2026*  
*Version: 4.0.0*  
*Author: Captain Wolfie*

